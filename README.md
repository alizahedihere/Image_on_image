تمرین اول 
پردازش تصویر یکی از شاخه های مهم علوم کامپیوتر است که به بررسی، تحلیل و تغییر تصاویر دیجیتال میپردازد. پردازش تصویر میتواند برای 
اهداف مختلفی از جمله بهبود کیفیت تصاویر، تشخیص الگوها، بازیابی اطالعات، ترکیب تصاویر و ایجاد اثرات هنری استفاده شود. برای پردازش تصویر، معموال 
از کتابخانه های مخصوصی که توابع و کالس های مربوط به کار با تصاویر را فراهم میکنند، استفاده میشود. یکی از این کتابخانه ها کتابخانه PIL یا Python
 Library Imagingاست که برای زبان برنامه نویسی پایتون طراحی شده است. این کتابخانه امکانات گسترده ای برای کار با تصاویر را در اختیار برنامه نویسان 
قرار میدهد.
در این سند، ما قصد داریم که با استفاده از کتابخانهPIL ، دو عکس را با هم ترکیب کنیم و یک عکس جدید از رنگهای مخلوط شده ایجاد کنیم. 
این کار را با استفاده از یک کد پایتون که در ادامه آورده شده است، انجام میدهیم. این کد یک عکس از پرتغال را از یک فایل با نام jpg.orange
بارگذاری میکند و یک قسمت از آن را برش میزند. سپس اندازه آن را تغییر میدهد و رنگ های آن را کمی تیره تر میکند. بعد از آن، یک عکس از ماه را از 
یک فایل با نام jpg.moon بارگذاری میکند و یک قسمت از آن را برش میزند. سپس رنگهای عکس پرتغال و عکس ماه را با هم میانگین میگیرد 
و یک عکس جدید از رنگهای مخلوط شده ایجاد می کند. در نهایت، این عکس جدید را روی عکس ماه قرار میدهد و نتیجه را نمایش و ذخیره میکند.
برای اجرای کد پایتون، ما نیاز به دو عکس با نام های jpg.orange و jpg.moon داریم. ما در این تمرین از دو عکس زیر استفاده کرده ایم:
orange.jpg
moon.jpg
همچنین ما نیاز به کتابخانه PIL داریم که باید آن را روی سیستم خود نصب کنیم. برای نصب این کتابخانه، می توانیم از دستور زیر در خ ط فرمان استفاده 
کنیم:
pip install Pillow
کتابخانه PIL شامل چندین کالس و تابع است که ما در کد خود از برخی از آنها استفاده کرده ایم. در ادامه به توضیح این کالس ها و توابع میپردازیم:
بخش توضیح مجدد کالس Image به شرح زیر است:
• کالس Image یکی از کالسهای اصلی کتابخانه PIL است که برای نمایش و پردازش تصاویر دیجیتال استفاده میشود. این کالس شامل چندین 
متد است که ما در این بخش ب ه برخی از آن ها اشاره میکنیم.
• mode : این متغیر نوع تصویر را مشخص میکند. برای مثال، اگر مقدار این متغیر RGB باشد، یعنی تصویر شامل سه کانال رنگی قرمز، سبز و 
آبی است. اگر مقدار این متغیر L باشد، یعنی تصویر شامل یک کانال سطح خاکستری است. برای دیدن لیست کامل از مقادیر ممکن برای این 
متغیر، میتوانید به ]مستندات رسمی[ مراجعه کنید.
• size : این متغیر اندازه تصویر را مشخص میکند. این متغیر یک تاپل از دو عدد است که به ترتیب نشان دهنده عرض و ارتفاع تصویر هستند. 
برای مثال، اگر مقدار این متغیر ),200 300( باشد، یعنی تصویر 200 پیکسل عرض و 300 پیکسل ارتفاع دارد.
• متد :open این متد یک رشته به عنوان نام فایل تصویر را به عنوان پارامتر میگیرد و یک شیء Image برمیگرداند. ما از این متد برای 
بارگذاری دو عکس jpg.orange و jpg.moon استفاده کرده ایم.
• Crop : این متد یک تاپل از چهار عدد را به عنوان پارامتر میگیرد و ی ک قسمت از تصویر را برش میزند. این تاپل مشخص میکند که قسمت 
برش زده شده از تصویر چه اندازه و چه مکانی دارد. این اعداد به ترتی ب نشان دهنده افقی شروع، عمودی شروع، افقی پایان و عمودی پایان 
هستند. ما از این متد برای برش دادن قسمتی از عکس پرتغال و عکس ماه استفاده کرده ایم.
• Resize : این متد دو پارامتر میگیرد. پارامتر اول یک تاپل از دو عدد است که اندازه جدید تصویر را مشخص میکند. پارامتر دوم یک عدد 
است که نوع الگوریتم تغییر اندازه را مشخص میکند. ما از این متد برا ی تغییر اندازه عکس پرتغال به اندازه قسمت برش زده شده از عکس 
ماه استفاده کرده ایم. همچنین از الگوریتم BICUBIC برای تغییر اندازه استفاده کرده ایم که ک یفیت باالتری نسبت به الگوریتم های دیگر 
دارد.
• Split : این متد یک شیء Image را به سه شیء Image تقسیم میکند که هر کدام نشان دهنده یکی از رنگهای قرمز، سبز و آبی هستند. ما 
از این متد برای جداسازی رنگ ها ی عکس پرتغال و عکس ماه استفاده کرده ایم.
• Getdata : این متد یک شیء Image را به عنوان پارامتر می گیرد و یک شیء قابل تکرار از مقادیر پ یکسلهای تصویر را برمیگرداند. ما از 
این متد برای دریافت مقادیر پیکسلهای رنگ های عکس پرتغال و عکس ماه استفاده کرده ایم.
• تابعmap : این تابع دو پارامتر میگیرد. پارامتر اول یک تابع است که بر روی هر عنصر از پارامتر دوم اعمال میشود. پارامتر دوم یک شی ء 
قابل تکرار است که مقادیر پیکسل های تصویر را شامل میشود. ما از ا ین تابع برای کاهش مقادیر پیکسل های رنگ های عکس پرتغال 
استفاده کرده ایم تا رنگهای آن را تیره تر کنیم.
• متدputdata : این متد دو پارامتر میگیرد. پارامتر اول یک شیء قابل تکرار از مقادیر پیکسل های تصو یر را شامل میشود. پارامتر دوم ی ک
شیء Image است که مقادیر پیکسلهای آن را با پارامتر اول جایگز ین میکند. ما از این متد برای اعمال تغییرات رنگی بر روی عکس پرتفال استفاده کرده ای م.
• متدmerge : این متد دو پارامتر م یگیرد. پارامتر اول یک رشته است که نوع تصویر را مشخص میکند. پارامتر دوم یک تاپل از سه شیء
 Imageاست که هر کدام نشان دهنده یکی از رنگ های قرمز، سبز و آبی هستند. این متد این سه شیء را با هم ترک یب می کند و یک شیء
 Imageجدید برمیگرداند. ما از ا ین متد برای ایجاد عکس جدید از رنگهای مخلوط شده استفاده کرده ایم.
• متدpaste : این متد دو پارامتر میگیرد. پارامتر اول یک شیء Image است که باید روی تصویر فعلی قرار گیرد. پارامتر دوم یک تاپل از دو 
عدد است که مکان شروع قرار گیر ی تصویر را مشخص میکند. ما از این متد برای قرار دادن عکس جدی د روی عکس ماه استفاده کرده ایم .
• متدshow : این متد هی چ پارامتری نمیگیرد و تصویر را در یک پنجره جدید نمایش می دهد. ما از این متد برای نمایش نتیجه کار خود استفاده 
کرده ایم.
• متد save : این متد یک رشته به عنوان نام فایل تصویر را به عنوان پارامتر میگیرد و تصویر را در آن فایل ذخیره میکند. ما از این متد برا ی 
ذخیره نتیجه کار خود با نام jpg.moon_on_orange استفاده کرده ایم.
با اجرای کد ، ما موفق شدیم که دو عکس را با هم ترک یب کنیم و ی ک عکس جدید از رنگ های مخلوط شده ایجاد کنیم. عکس نهایی که به دست آمد به 
شکل زیر است:
orange_on_moon.jpg
در عکس نهایی، میتوانیم ببینیم که عکس پرتغال با عکس ماه ترک یب شده است. رنگهای عکس پرتغال کمی تیره تر شده اند و با رنگهای عکس 
ماه میانگین گرفته شده اند. این باعث شده است که عکس پرتغال با زمینه عکس ماه هماهنگ شود و یک تصویر واحد به نظر برسد.
این عمل نشان میدهد که با استفاده از کتابخانه PIL، میتوانیم تصاوی ر را به راحتی پردازش و ترک یب کن یم و اثرات هنری جذابی ایجاد کنی م. البته این کار 
فقط یک نمونه از امکانات این کتابخانه است و میتوان یم با استفاده از توابع و کالسهای دیگر این کتابخانه، انواع دیگری از پردازش تصوی ر را انجام ده یم. 
برای مثال، می توانیم تصاویر را فیلتر کنیم، روتیشن بدهیم، کانتراست و روشنایی آن ها را تغییر دهیم، تشخیص چهره و شناسایی اشیا را انجام دهیم و غیره . برای 
کسب اطالعات بی شتر در مورد کتابخانه PIL، میتوانید به مستندات رسمی آن مراجعه کنید.
در ادامه بصورت خط به خط توضیحات فارسی کد ارائه می شود: 
from PIL import Image 
این خط کتابخانه PIL را وارد میکند تا بتوانیم از کالسها و توابع آن برای کار با تصاویر استفاده کنیم.
orange = Image.open("orange.jpg") 
این خط یک شیء از کالس Image با نام orange ایجاد میکند و عکس پرتغال را از فایل jpg.orange بارگذاری میکند.
moon = Image.open("moon.jpg") 
این خط یک شیء از کالس Image با نام moon ایجاد میکند و عکس ماه را از فایل jpg.moon بارگذاری می کند.
box=(240,79,465,360) 
این خط یک متغیر با نام box تعریف میکند و یک تاپل از چهار عدد را به آن مقدار میدهد. این تاپل مشخص میکند که قسمت برش زده شده از عکس 
پرتغال چه اندازه و چه مکانی دارد.
orange = orange.crop(box) 
این خط متد crop را روی شیء orange صدا می زند و پارامتر box را به آن میدهد. این متد یک قسمت از تصویر را برش میزند و یک شیء Image
جدید برمیگرداند. ما از این متد برای برش دادن قسمتی از عکس پرتغال استفاده کرده ایم.
orange = orange.resize((111, 106), Image.BICUBIC) 
این خط متد resize را روی شیء orange صدا میزند و دو پارامتر به آن میدهد. پارامتر اول یک تاپل از دو عدد است که اندازه جدید تصویر را مشخص 
میکند. پارامتر دوم یک عدد است که نوع الگوریتم تغییر اندازه را مشخص میکند. ما از این متد برا ی تغ ییر اندازه عکس پرتغال به اندازه قسمت برش زده 
شده از عکس ماه استفاده کرده ایم . همچنین از الگوریتم BICUBIC برای تغییر اندازه استفاده کرده ای م که ک یفیت باالتری نسبت به الگوریتمهای دیگر دارد.
orange_red, orange_green, orange_blue = orange.split() 
این خط متد split را روی شیء orange صدا می زند و سه شیء Image را به عنوان خروجی میدهد. ا ین سه شیء هر کدام نشان دهنده ی کی از رنگهای 
قرمز، سبز و آبی هستند. ما از این متد برای جداسازی رنگ های عکس پرتغال استفاده کرده ایم.
list_orange_red = list(orange_red.getdata()) 
این خط متد getdata را روی ش یء red_orange صدا میزند و ی ک شیء قابل تکرار از مقادیر پیکسلهای تصویر را برمیگرداند. سپس این شیء را به یک 
لیست تبدیل میکند و آن را در ی ک متغیر با نام red_orange_list ذخیره میکند. ما از این خط برا ی دریافت مقادیر پیکسلهای رنگ قرمز عکس پرتغال استفاده کرده ای م.
list_orange_green = list(orange_green.getdata()) 
این خط متد getdata را روی ش یء green_orange صدا میزند و یک شیء قابل تکرار از مقادیر پی کسلهای تصویر را برمیگرداند. سپس این شیء را به 
یک لیست تبدیل میکند و آن را در یک متغیر با نام green_orange_list ذخی ره میکند. ما از این خط برای دریافت مقادیر پیکسل های رنگ سبز عکس 
پرتغال استفاده کرده ایم.
list_orange_blue = list(orange_blue.getdata()) 
این خط متد getdata را روی ش یء blue_orange صدا می زند و یک شیء قابل تکرار از مقادیر پیکسلهای تصویر را برمیگرداند. سپس این شیء را به 
یک لیست تبدیل میکند و آن را در یک متغیر با نام blue_orange_list ذخیره میکند. ما از این خط برای دریافت مقادیر پیکسل های رنگ آبی عکس پرتغال استفاده کرده ای م.
list_orange_red = list(map(lambda x: x - 150, list_orange_red)) 
این خط تابع map را صدا میزند و دو پارامتر به آن میدهد. پارامتر اول یک تابع بینام است که بر رو ی هر عنصر از پارامتر دوم اعمال میشود. این تابع یک 
عدد را به عنوان ورود ی میگیرد و 150 واحد از آن کم میکند. پارامتر دوم لیست مقادیر پیکسل های رنگ قرمز عکس پرتغال است. ا ین تابع برای هر 
عنصر از این لیست، 150 واحد کم میکند و یک لی ست جدی د برمیگرداند. ما از این خط برای کاهش مقادیر پیکسلهای رنگ قرمز عکس پرتغال استفاده 
کرده ایم تا رنگهای آن را تیره تر کنیم.
list_orange_green = list(map(lambda x: x - 150, list_orange_green)) 
این خط مشابه خط قبلی عمل میکند، با این تفاوت که بر روی لیست مقادیر پیکسلهای رنگ سبز عکس پرتغال اعمال میشود. ما از این خط برای 
کاهش مقادیر پیکسلهای رنگ سبز عکس پرتغال استفاده کرده ایم تا رنگ های آن را ت یره تر کنیم.
list_orange_blue = list(map(lambda x: x - 150, list_orange_blue)) 
این خط مشابه خط قبلی عمل میکند، با این تفاوت که بر روی لیست مقادیر پیکسلهای رنگ آبی عکس پرتغال اعمال میشود. ما از این خط برای 
کاهش مقادیر پیکسلهای رنگ آب ی عکس پرتغال استفاده کرده ایم تا رنگ های آن را تیره تر کنیم.
orange_red.putdata(list_orange_red) 
این خط متد putdata را روی ش یء red_orange صدا میزند و پارامتر red_orange_list را به آن میدهد. این متد مقادیر پیکسل های شیء
 red_orangeرا با مقادیر پیکسل های لیست red_orange_list جایگزین میکند. ما از این خط برای اعمال تغییرات رنگی بر روی رنگ قرمز عکس پرتغال استفاده کرده ای م.
orange_green.putdata(list_orange_green) 
این خط مشابه خط قبلی عمل میکند، با این تفاوت که بر روی شیء green_orange و لیست green_orange_list اعمال میشود. ما از این خط برای 
اعمال تغییرات رنگی بر روی رنگ سبز عکس پرتغال استفاده کرده ایم.
orange_blue.putdata(list_orange_blue) 
این خط مشابه خط قبلی عمل میکند، با این تفاوت که بر روی شیء blue_orange و ل یست blue_orange_list اعمال میشود. ما از ای ن خط برای اعمال 
تغییرات رنگی بر رو ی رنگ آبی عکس پرتغال استفاده کرده ایم.
new_orange = Image.merge("RGB",(orange_red,orange_green,orange_blue)) 
این خط متد merge را صدا میزند و دو پارامتر به آن میدهد. پارامتر اول یک رشته با مقدار "RGB "است که نوع تصویر جدید را مشخص میکند. پارامتر 
دوم یک تاپل از سه شیء Image است که هر کدام نشان دهنده یکی از رنگ های قرمز، سبز و آبی هستند. این متد این سه شیء را با هم ترک یب میکند و یک 
شیء Image جدید با نام orange_new برمیگرداند. ما از این خط برای ایجاد عکس جدید از رنگ های تیره شده عکس پرتغال استفاده کرده ای م. 
moon_crop = moon.crop((173, 59, 173 + 111, 59 + 106))
این خط متد crop را روی شیء moon صدا میزند و یک تاپل از چهار عدد را به آن می دهد. این تاپل مشخص میکند که قسمت برش زده شده از عکس 
ماه چه اندازه و چه مکانی دارد. ما از این خط برای برش دادن قسمتی از عکس ماه به همان اندازه عکس پرتغال استفاده کرده ایم.
orange_red, orange_green, orange_blue = new_orange.split()
این خط متد split را روی شیء orange_new صدا میزند و سه شیء Image را به عنوان خروجی میدهد. این سه شیء هر کدام نشاندهنده یکی از 
رنگهای قرمز، سبز و آبی هستند. ما از این متد برای جداسازی رنگهای عکس جدید از رنگ های تیره شده عکس پرتغال استفاده کرده ایم.
moon_red, moon_green, moon_blue = moon_crop.split()
این خط متد split را روی شیء crop_moon صدا میزند و سه شیء Image را به عنوان خروجی میدهد. این سه شیء هر کدام نشاندهنده یکی از 
رنگهای قرمز، سبز و آبی هستند. ما از این متد برای جداسازی رنگهای قسمت برش زده شده از عکس ماه استفاده کرده ایم.
list_orange_red = list(orange_red.getdata())
این خط متد getdata را روی شیء red_orange صدا میزند و یک شیء قابل تکرار از مقادیر پیکسلهای تصویر را برمیگرداند. سپس این شیء را به یک 
لیست تبدیل میکند و آن را در یک متغیر با نام red_orange_list ذخیره میکند. ما از این خط برای دریافت مقادیر پیکسلهای رنگ قرمز عکس جدید 
استفاده کرده ایم.
list_orange_green = list(orange_green.getdata())
این خط متد getdata را روی شیء green_orange صدا میزند و یک شیء قابل تکرار از مقادیر پیکسلهای تصویر را برمیگرداند. سپس این شیء را به 
یک لیست تبدیل میکند و آن را در یک متغیر با نام green_orange_list ذخیره میکند. ما از این خط برای دریافت مقادیر پیکسل های رنگ سبز عکس 
جدید استفاده کرده ایم.
list_orange_blue = list(orange_blue.getdata())
این خط متد getdata را روی شیء blue_orange صدا می زند و یک شیء قابل تکرار از مقادیر پیکسلهای تصویر را برمیگرداند. سپس این شیء را به 
یک لیست تبدیل میکند و آن را در یک متغیر با نام blue_orange_list ذخیره میکند. ما از این خط برای دریافت مقادیر پیکسل های رنگ آبی عکس 
جدید استفاده کرده ایم.
list_moon_red = list(moon_red.getdata())
این خط متد getdata را روی شیء red_moon صدا میزند و یک شیء قابل تکرار از مقادیر پیکسلهای تصویر را برمیگرداند. سپس این شیء را به یک 
لیست تبدیل میکند و آن را در یک متغیر با نام red_moon_list ذخیره میکند. ما از این خط برای دریافت مقادیر پیکسلهای رنگ قرمز قسمت برش زده 
شده از عکس ماه استفاده کرده ایم.
list_moon_green = list(moon_green.getdata())
این خط متد getdata را روی شیء green_moon صدا میزند و یک شیء قابل تکرار از مقادیر پیکسلهای تصویر را برمیگرداند. سپس این شیء را به 
یک لیست تبدیل میکند و آن را در یک متغیر با نام green_moon_list ذخیره میکند. ما از این خط برای دریافت مقادیر پیکسل های رنگ سبز قسمت 
برش زده شده از عکس ماه استفاده کرده ایم.
list_moon_blue = list(moon_blue.getdata())
این خط متد getdata را روی شیء blue_moon صدا می زند و یک شیء قابل تکرار از مقادیر پیکسلهای تصویر را برمیگرداند. سپس این شیء را به 
یک لیست تبدیل میکند و آن را در یک متغیر با نام blue_moon_list ذخیره میکند. ما از این خط برای دریافت مقادیر پیکسل های رنگ آبی قسمت 
برش زده شده از عکس ماه استفاده کرده ایم.
list_avg_red = [(a + b) // 2 for a, b in zip(list_orange_red, list_moon_red)]
این خط یک لیست جامع از مقادیر پیکسل های رنگ قرمز عکس جدید را ایجاد میکند. این لیست با استفاده از تابع zip و یک حلقه for محاسبه میشود. 
تابع zip دو لیست را به عنوان پارامتر میگیرد و یک شیء قابل تکرار از جفت های متناظر از این دو لیست برمیگرداند. 
list_avg_red = [(a + b) // 2 for a, b in zip(list_orange_red, list_moon_red)]
این خط یک لیست جامع از مقادیر پیکسل های رنگ قرمز عکس جدید را ایجاد میکند. این لیست با استفاده از تابع zip و یک حلقه for محاسبه میشود. 
تابع zip دو لیست را به عنوان پارامتر میگیرد و یک شیء قابل تکرار از جفت های متناظر از این دو لیست برمیگرداند. حلقه for برای هر جفت از مقادیر 
پیکسلهای رنگ قرمز عکس پرتغال و عکس ماه، میانگین حسابی آنها را محاسبه میکند و به لیست جدید اضافه میکند. ما از این خط برای میانگین 
گرفتن رنگهای قرمز دو عکس استفاده کرده ایم.
list_avg_green = [(a + b) // 2 for a, b in zip(list_orange_green, list_moon_green)]
این خط مشابه خط قبلی عمل میکند، با این تفاوت که بر روی لیست های مقادیر پیکسل های رنگ سبز دو عکس اعمال میشود. ما از این خط برای میانگین 
گرفتن رنگهای سبز دو عکس استفاده کرده ایم.
list_avg_blue = [(a + b) // 2 for a, b in zip(list_orange_blue, list_moon_blue)]
این خط مشابه خط قبلی عمل میکند، با این تفاوت که بر روی لیست های مقادیر پیکسل های رنگ آبی دو عکس اعمال میشود. ما از این خط برای میانگین 
گرفتن رنگهای آبی دو عکس استفاده کرده ایم.
new_orange.putdata(list_avg_red, 0)
این خط متد putdata را روی شیء orange_new صدا میزند و دو پارامتر به آن میدهد. پارامتر اول لیست مقادیر پیکسل های رنگ قرمز عکس جدید 
است. پارامتر دوم یک عدد با مقدار صفر است که نشاندهنده شماره کانال رنگی است. این متد مقادیر پیکسلهای کانال رنگی مشخص شده شیء
 orange_newرا با مقادیر پیکسل های لیست داده شده جایگزین میکند. ما از این خط برای اعمال رنگهای میانگین شده قرمز بر روی عکس جدید استفاده 
کرده ایم.
new_orange.putdata(list_avg_green, 1)
این خط مشابه خط قبلی عمل میکند، با این تفاوت که بر روی کانال رنگی شماره یک که نشان دهنده رنگ سبز است اعمال میشود. ما از این خط برای 
اعمال رنگهای میانگین شده سبز بر روی عکس جدید استفاده کرده ایم.
new_orange.putdata(list_avg_blue, 2)
این خط مشابه خط قبلی عمل میکند، با این تفاوت که بر روی کانال رنگی شماره دو که نشان دهنده رنگ آبی است اعمال میشود. ما از این خط برای اعمال 
رنگهای میانگین شده آبی بر روی عکس جدید استفاده کرده ایم.
moon.paste(new_orange, (173, 59))
این خط متد paste را روی شیء moon صدا میزند و دو پارامتر به آن می دهد. پارامتر اول شیء orange_new است که باید روی تصویر فعلی قرار گیرد. 
پارامتر دوم یک تاپل از دو عدد است که مکان شروع قرار گیری تصویر را مشخص میکند. ما از این خط برای قرار دادن عکس جدید روی عکس ماه استفاده 
کرده ایم.
moon.show()
این خط متد show را روی شیء moon صدا میزند و هیچ پارامتری به آن نمیدهد. این متد تصویر را در یک پنجره جدید نمایش میدهد. ما از این خط 
برای نمایش نتیجه کار خود استفاده کرده ایم.
moon.save(“orange_on_moon.jpg”)
این خط متد save را روی شیء moon صدا میزند و یک رشته به عنوان نام فایل تصویر را به عنوان پارامتر میگیرد. این متد تصویر را در فایل مشخص شده 
ذخیره میکند. ما از این خط برای ذخیره نتیجه کار خود با نام jpg.moon_on_orange استفاده کرده ایم.
